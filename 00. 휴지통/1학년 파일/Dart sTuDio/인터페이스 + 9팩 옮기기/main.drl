w = '5 0 0 W S S 0 1 0 6 % D W 0 0 0 0 0 0 0 5'.split() 
r = '5 0 0 R S S 0 1 0 6 % D W 0 0 0 5'.split() 
w[0],r[0] = [5] * 2
w[20],r[16] = [4] * 2
for i in range(1,20):
    w[i] = ord(w[i])
    if i < 16: r[i] = ord(r[i])

def write(ad, val):
    ser = serial_open(port="COM")
    w[14] = ord(str(ad // 10))     
    w[15] = ord(str(ad % 10))     
    w[18] = ord(str(0)) if val < 16 else ord(hex(val)[2])
    w[19] = ord(hex(val)[2]) if val < 16 else ord(hex(val)[3])
    ser.write(bytearray(w))
    serial_close(ser)
    wait(0.02)

def read(ad):
    ser = serial_open(port="COM")
    r[14] = ord(str(ad // 10))
    r[15] = ord(str(ad % 10))
    ser.write(bytearray(r))
    wait(0.02)
    r1 = ser.read(ser.inWaiting())
    r2 = r1.decode()
    sum = int(r2[10:14],16)
    return sum
#=====================================================================================================================


a1 = posx(298.89, 300.09, 25, 34.19, 180, 31.53)
b1 = posx(259.02, 300.14, 24.99, 66.41, -179.99, 63.46)
c1 = posx(219.44, 300.6, 24.78, 83.43, -180, 80.33)
d1 = posx(299.4, 340.48, 25.25, 68.24, -180, 65.39)
e1 = posx(259.48, 339.9, 25.15, 59.02, -179.99, 56.01)
f1 = posx(219.92, 341.3, 24.92, 66.32, -180, 63.17)
g1 = posx(299.46, 381.49, 25.24, 51.14, -179.99, 48.14)
h1 = posx(259.43, 379.7, 25.3, 71.35, -179.99, 68.93)
i1 = posx(219.01, 381.25, 25.11, 66.64, -180, 63.46)

a2 = posx(-120.46, 301.17, 24.71, 122.33, -180, 118.72)
b2 = posx(-160.13, 301.76, 24.89, 96.88, 180, 93)
c2 = posx(-200.39, 302.7, 24.94, 122.53, -180, 118.71)
d2 = posx(-120.49, 342.45, 24.86, 88.1, -180, 84.21)
e2 = posx(-160.32, 340.45, 25.1, 116.46, -180, 112.08)
f2 = posx(-200.26, 340.57, 25.15, 119.56, 179.99, 114.9) 
g2 = posx(-120.99, 380.3, 25.11, 75.56, -180, 71.05)
h2 = posx(-160.38, 379.67, 25.53, 106.28, -179.99, 103.52)
i2 = posx(-200.7, 380.42, 25.7, 77.54, 180, 72.71)

au1 = posx(298.89, 300.09, 25+80, 34.19, 180, 31.53)
bu1 = posx(259.02, 300.14, 24.99+80, 66.41, -179.99, 63.46)
cu1 = posx(219.44, 300.6, 24.78+80, 83.43, -180, 80.33)
du1 = posx(299.4, 340.48, 25.25+80, 68.24, -180, 65.39)
eu1 = posx(259.48, 339.9, 25.15+80, 59.02, -179.99, 56.01)
fu1 = posx(219.92, 341.3, 24.92+80, 66.32, -180, 63.17)
gu1 = posx(299.46, 381.49, 25.24+80, 51.14, -179.99, 48.14)
hu1 = posx(259.43, 379.7, 25.3+80, 71.35, -179.99, 68.93)
iu1 = posx(219.01, 381.25, 25.11+80, 66.64, -180, 63.46)

au2 = posx(-120.46, 301.17, 24.71+80, 122.33, -180, 118.72)
bu2 = posx(-160.13, 301.76, 24.89+80, 96.88, 180, 93)
cu2 = posx(-200.39, 302.7, 24.94+80, 122.53, -180, 118.71)
du2 = posx(-120.49, 342.45, 24.86+80, 88.1, -180, 84.21)
eu2 = posx(-160.32, 340.45, 25.1+80, 116.46, -180, 112.08)
fu2 = posx(-200.26, 340.57, 25.15+80, 119.56, 179.99, 114.9) 
gu2 = posx(-120.99, 380.3, 25.11+80, 75.56, -180, 71.05)
hu2 = posx(-160.38, 379.67, 25.53+80, 106.28, -179.99, 103.52)
iu2 = posx(-200.7, 380.42, 25.7+80, 77.54, 180, 72.71)
'''
for a in range(1,10):
    write(a,1)

for b in range(1,10):
    write(b,0)
    write(b+9,1)
    wait(0.3)
    
for c in range(1,19):
    write(c,0)
'''
c = [a1,b1,c1,d1,e1,f1,g1,h1,i1,a2,b2,c2,d2,e2,f2,g2,h2,i2]
cu = [au1, bu1, cu1, du1, eu1, fu1, gu1, hu1, iu1,au2, bu2, cu2, du2, eu2, fu2, gu2, hu2, iu2]

move_home(1)
set_tool_digital_outputs([-1,2])
for s in range(1,19):
    write(s,0)
for a in range(1,10):
    write(a,1)

for a in range(0,9):# a = 0~8
    movel(cu[a], 500, 00)
    movel(c[a], 300, 300)
    set_tool_digital_outputs([1,-2])
    write(a+1,0)
    movel(cu[a], 300, 300)
    
    movel(cu[a+9], 300, 300)
    movel(c[a+9], 300, 300)
    set_tool_digital_outputs([-1,2])
    write(a+10,1)
    movel(cu[a+9], 300, 300)
    wait(0.3)